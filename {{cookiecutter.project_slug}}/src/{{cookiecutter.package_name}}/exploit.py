#!/usr/bin/env python3
"""Main exploit code for {{ cookiecutter.project_name }}"""

import requests
from {{ cookiecutter.package_name }}.utils.output import out

# Disable SSL warnings
requests.packages.urllib3.disable_warnings()


def run(args):
    """Main exploit function

    Args:
        args: Arguments from argparse (target, proxy, verbose, etc)
    """
    target = args.target.rstrip('/')

    out.info(f"Starting exploit against {target}")

    # Configure session
    session = requests.Session()
    session.verify = False

    if args.proxy:
        session.proxies = {
            'http': args.proxy,
            'https': args.proxy
        }
        out.info(f"Using proxy: {args.proxy}")

    # TODO: Add your exploit code here
    # Example:
    # response = session.get(f"{target}/vulnerable-endpoint")
    # if "success" in response.text:
    #     out.success("Target is vulnerable!")
    # else:
    #     out.error("Target not vulnerable")

    out.warning("Exploit not implemented yet")


if __name__ == "__main__":
    # Quick test
    import argparse
    parser = argparse.ArgumentParser()
    parser.add_argument("--target", default="http://localhost")
    parser.add_argument("--proxy", default=None)
    parser.add_argument("--verbose", action="store_true")
    args = parser.parse_args()

    run(args)